<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>planner</title>
  <meta name="description" content="calendar + tasks" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <h1><a href="index.html">JB's blog</a></h1>
        <p class="tagline"></p>
      </div>
      <nav aria-label="Fő navigáció">
        <a class="navlink" href="index.html">entries</a>
        <a class="navlink" href="photos.html">photos</a>
        <a class="navlink" href="lists.html">lists</a>
        <a class="navlink" href="about.html">cv</a>
        <a class="navlink" href="planner.html" aria-current="page">planner</a>
      </nav>
    </header>

    <section class="card">
      <div class="meta">calendar + tasks</div>
    </section>

    <hr />

    <div class="planner-grid">
      <!-- CALENDAR -->
      <section>
        <div class="meta">google calendar</div>
        <div class="calwrap">
          <iframe
            src="https://calendar.google.com/calendar/embed?src=juhaszblnt%40gmail.com&ctz=Europe%2FBudapest"
            style="border:0"
            width="100%"
            height="720"
            frameborder="0"
            scrolling="no">
          </iframe>
        </div>
      </section>

      <!-- TASKS -->
      <section>
        <div class="meta">tasks</div>

        <form id="todoForm" class="todo-form">
          <input id="todoInput" class="todo-input" type="text" placeholder="új task..." autocomplete="off" />
          <button class="todo-btn" type="submit">add</button>
        </form>

        <ul id="todoList" class="todo-list"></ul>

        <button id="clearDone" class="todo-clear" type="button">clear done</button>
      </section>
    </div>

    <footer>
      <div>© <span id="y"></span> JB · <span class="code">planner</span></div>
    </footer>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // --- simple localStorage todo ---
    const KEY = "jb_blog_todos_v1";
    const form = document.getElementById("todoForm");
    const input = document.getElementById("todoInput");
    const list = document.getElementById("todoList");
    const clearDoneBtn = document.getElementById("clearDone");

    function loadTodos(){
      try { return JSON.parse(localStorage.getItem(KEY) || "[]"); }
      catch { return []; }
    }

    function saveTodos(todos){
      localStorage.setItem(KEY, JSON.stringify(todos));
    }

    function render(){
      const todos = loadTodos();
      list.innerHTML = "";
      todos.forEach((t, idx) => {
        const li = document.createElement("li");
        li.className = "todo-item";

        const cb = document.createElement("input");
        cb.type = "checkbox";
        cb.checked = !!t.done;
        cb.addEventListener("change", () => {
          const next = loadTodos();
          next[idx].done = cb.checked;
          saveTodos(next);
          render();
        });

        const span = document.createElement("span");
        span.className = "todo-text";
        span.textContent = t.text;
        if(t.done) span.classList.add("done");

        const del = document.createElement("button");
        del.type = "button";
        del.className = "todo-del";
        del.textContent = "×";
        del.addEventListener("click", () => {
          const next = loadTodos().filter((_, i) => i !== idx);
          saveTodos(next);
          render();
        });

        li.appendChild(cb);
        li.appendChild(span);
        li.appendChild(del);
        list.appendChild(li);
      });
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const text = (input.value || "").trim();
      if(!text) return;
      const todos = loadTodos();
      todos.unshift({ text, done: false, ts: Date.now() });
      saveTodos(todos);
      input.value = "";
      render();
    });

    clearDoneBtn.addEventListener("click", () => {
      const next = loadTodos().filter(t => !t.done);
      saveTodos(next);
      render();
    });

    render();
  </script>
</body>
</html>
